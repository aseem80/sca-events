files:
  "/etc/filebeat/filebeat.yml":
    content: |
      output.elasticsearch:
        hosts: [ '{{ ELASTIC_HOST }}' ]
        template.enabled: false
        headers:
          X-API-Key: {{ env.DATALENS_API_KEY }}
      logging:
        level: info
        to_files: false
        to_syslog: true
      filebeat.prospectors:
      - input_type: log
        document_type: sca_applog
        paths:
        - /var/tmp/logs/sca-events/sca-events.log
        fields:
          datalens.env: {{env.APPLICATION_VERSION}}
          appGroup: org
          appName: sca
          logType: applog
          logEnv: non-prod
        # match any lines that don't start with '{' or a date and connect them to the line before.
        multiline:
          pattern: '^({|\d{4}-\d{2}-\d{2})'
          negate: true
          match: after

services:
  sysvinit:
    filebeat:
      enabled: "true"
      ensureRunning: "true"
      files:
        - /etc/filebeat/filebeat.yml
